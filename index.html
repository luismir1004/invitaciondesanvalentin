<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Para Ti ❤️</title>
    <meta name="description" content="Una experiencia inmersiva de San Valentín.">

    <!-- Open Graph / Premium Sharing -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Para Ti ❤️ — San Valentín">
    <meta property="og:description" content="Una carta digital, un momento especial.">
    <meta property="og:image" content="assets/bouquet-hero.png">
    <meta property="theme-color" content="#0a090f">

    <!-- PWA / App Icon -->
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="apple-touch-icon" href="assets/icon-192.png">
    <link rel="manifest" href="manifest.json">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">

    <!-- GSAP + Plugins (sync — must load before modules) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <!-- Canvas Confetti (sync — must load before modules) -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="theme.css">
</head>

<body aria-busy="true">
    <!-- ── Premium Preloader ────────────────────────────────────── -->
    <div id="preloader" aria-hidden="true">
        <div class="preloader-heart">
            <svg viewBox="0 0 32 32" width="60" height="60">
                <path fill="url(#gold)"
                    d="M16,28.26l-1.93-1.75C7.21,20.29,2.67,16.17,2.67,11.12C2.67,7.01,5.76,3.92,9.87,3.92c2.32,0,4.54,1.08,6.13,2.8c1.59-1.72,3.81-2.8,6.13-2.8c4.11,0,7.2,3.09,7.2,7.2c0,5.05-4.54,9.17-11.4,15.39L16,28.26z" />
                <defs>
                    <linearGradient id="gold" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#fcf6ba;stop-opacity:1" />
                        <stop offset="50%" style="stop-color:#bf953f;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#b38728;stop-opacity:1" />
                    </linearGradient>
                </defs>
            </svg>
        </div>
    </div>

    <!-- ── Fullscreen Canvases ──────────────────────────────────── -->
    <canvas id="particle-field" aria-hidden="true"></canvas>
    <canvas id="cursor-trail" aria-hidden="true"></canvas>

    <!-- ── Mesh Gradient Background ─────────────────────────────── -->
    <div class="mesh-bg" id="mesh-bg" aria-hidden="true"></div>

    <div class="ambient-orbs" aria-hidden="true">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <main class="container" id="main-container">

        <!-- ═══════════════════════════════════════════════════════════
         PHASE 1: UNLOCK SCREEN — Cinematic "Golden Gate"
         ═══════════════════════════════════════════════════════════ -->
        <section id="unlock-section" class="unlock-screen" aria-label="Pantalla de desbloqueo">
            <div class="unlock-content">
                <h1 class="unlock-title">San Valentín</h1>
                <p class="unlock-label">Por favor, traza la “A” de Alejandra</p>

                <div class="canvas-wrapper">
                    <div class="unlock-glow" aria-hidden="true"></div>
                    <canvas id="draw-canvas" width="200" height="200" aria-label="Canvas para dibujar inicial"></canvas>
                    <div class="canvas-ring" aria-hidden="true"></div>
                </div>

                <button id="clear-draw-btn" class="clear-btn" aria-label="Borrar dibujo">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="16"
                        height="16">
                        <path
                            d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.992 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182"
                            stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </button>
            </div>
        </section>

        <!-- ═══════════════════════════════════════════════════════════
         PHASE 2: ENVELOPE
         ═══════════════════════════════════════════════════════════ -->
        <section id="envelope-section" class="envelope-wrapper" aria-label="Sobre de carta" hidden>
            <div class="envelope" data-parallax-depth="0.05">
                <div class="envelope-back"></div>
                <div class="envelope-card-preview"></div>
                <div class="envelope-body">
                    <!-- Texture overlay handled in CSS -->
                </div>
                <div class="envelope-flap"></div>
                <div class="envelope-seal" role="button" aria-label="Abrir carta">
                    <span class="seal-text">L & A</span>
                </div>
            </div>

            <!-- Removed separate open button, interaction is now on the seal/envelope -->
        </section>

        <!-- ═══════════════════════════════════════════════════════════
         PHASE 3: CARD — Main Content (Revealed)
         ═══════════════════════════════════════════════════════════ -->
        <article id="card-section" class="card" aria-label="Tarjeta de San Valentín" hidden>
            <div class="card-inner" data-parallax-depth="0.04">

                <!-- Header -->
                <header class="card-header">
                    <p class="card-date">14 de Febrero</p>
                    <h1 class="card-title">Para Alejandra<br><em>Mi Vida Entera</em></h1>
                </header>

                <!-- Bouquet Fotorrealista -->
                <div id="bouquet-container" class="bouquet-container" aria-label="Ramo de flores">
                    <img id="bouquet-image" class="bouquet-image" src="assets/bouquet-hero-black.png"
                        alt="Ramo de rosas y peonías" draggable="false" />
                    <canvas id="pollen-canvas" aria-hidden="true"></canvas>
                    <div class="bouquet-glow" aria-hidden="true"></div>
                </div>

                <!-- Divider -->
                <div class="divider" aria-hidden="true">
                    <span class="divider-heart">♥</span>
                </div>

                <!-- Message -->
                <section class="card-message" aria-label="Mensaje">
                    <p class="message-line">Ale, cada día a tu lado es un regalo que no sabía que el universo podía dar.
                    </p>
                    <p class="message-line">No necesito grandes gestos para saber que lo nuestro es extraordinario.</p>
                    <p class="message-line">Eres la razón por la que creo en la magia de lo cotidiano.</p>
                    <p class="message-line signature">Tu Luis ∞</p>
                </section>

                <!-- Music Player with Visualizer -->
                <section class="music-player" aria-label="Reproductor de música">
                    <div class="player-cover">
                        <div class="cover-art">
                            <div class="cover-gradient" aria-hidden="true"></div>
                            <svg class="cover-note" viewBox="0 0 24 24" fill="currentColor" width="28" height="28"
                                aria-hidden="true">
                                <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 
                         4-1.79 4-4V7h4V3h-6z" />
                            </svg>
                        </div>
                    </div>
                    <div class="player-info">
                        <p class="song-title">Domingo Familiar</p>
                        <p class="song-artist">Rawayana</p>
                        <div class="visualizer-wrapper">
                            <div class="equalizer">
                                <div class="bar"></div>
                                <div class="bar"></div>
                                <div class="bar"></div>
                                <div class="bar"></div>
                            </div>
                        </div>
                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                            aria-valuemax="100">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="player-time">
                            <span class="time-current">0:00</span>
                            <span class="time-total">3:45</span>
                        </div>
                    </div>
                </section>

                <!-- Memories Gallery (Masonry) -->
                <section class="memories-section" aria-label="Galería de recuerdos">
                    <p class="section-label">Nuestros Recuerdos</p>
                    <div class="masonry-grid" id="masonry-grid">
                        <div class="memory-card memory-tall" data-parallax-depth="0.02">
                            <img src="assets/1B4ED299-73D3-440E-B6CE-07CA598536BB_1_105_c.jpeg" alt="Nosotros juntos"
                                loading="lazy" decoding="async">
                            <span class="memory-caption">Momentos únicos</span>
                        </div>
                        <div class="memory-card" data-parallax-depth="0.03">
                            <img src="assets/1DDEEA17-9661-4E66-A144-544FE9B2EE1F_1_105_c.jpeg"
                                alt="Viajes inolvidables" loading="lazy" decoding="async">
                            <span class="memory-caption">Viajando a tu lado</span>
                        </div>
                        <div class="memory-card" data-parallax-depth="0.02">
                            <img src="assets/387AE7EE-CD9C-4D67-8C7F-53235A1E9536_1_105_c.jpeg" alt="Nuestra felicidad"
                                loading="lazy" decoding="async">
                            <span class="memory-caption">Felicidad pura</span>
                        </div>
                        <div class="memory-card memory-tall" data-parallax-depth="0.04">
                            <img src="assets/3CC4B55C-E7AB-482E-BD1D-225C0694A19B_1_105_c.jpeg" alt="Aventuras"
                                loading="lazy" decoding="async">
                            <span class="memory-caption">Aventuras compartidas</span>
                        </div>
                        <div class="memory-card" data-parallax-depth="0.015">
                            <img src="assets/6A610084-9BF4-4190-819F-235F23BA71E4_1_105_c.jpeg" alt="Tú y yo"
                                loading="lazy" decoding="async">
                            <span class="memory-caption">Simplemente tú y yo</span>
                        </div>
                        <div class="memory-card" data-parallax-depth="0.025">
                            <img src="assets/8C608867-3085-47CA-B0F1-E7A589FDB036_1_105_c.jpeg" alt="Amor eterno"
                                loading="lazy" decoding="async">
                            <span class="memory-caption">Para siempre</span>
                        </div>
                    </div>
                </section>

                <!-- Counter -->
                <section class="counter-section" aria-label="Contador de tiempo juntos">
                    <p class="counter-label">Llevamos compartiendo momentos</p>
                    <div class="counter-grid" id="counter-grid">
                        <div class="counter-item">
                            <span class="counter-value" id="counter-days">0</span>
                            <span class="counter-unit">días</span>
                        </div>
                        <div class="counter-item">
                            <span class="counter-value" id="counter-hours">0</span>
                            <span class="counter-unit">horas</span>
                        </div>
                        <div class="counter-item">
                            <span class="counter-value" id="counter-minutes">0</span>
                            <span class="counter-unit">minutos</span>
                        </div>
                        <div class="counter-item">
                            <span class="counter-value" id="counter-seconds">0</span>
                            <span class="counter-unit">segundos</span>
                        </div>
                    </div>
                </section>

                <!-- RSVP Section -->
                <section id="rsvp-section" class="rsvp-section" aria-label="Confirmación de cita">
                    <p class="rsvp-label">¿Aceptas esta invitación?</p>
                    <div id="rsvp-card" class="rsvp-royal-card">
                        <div class="seal-interaction-container">
                            <button id="royal-seal-btn" class="royal-seal-btn"
                                aria-label="Mantén presionado para aceptar">
                                <div class="pergam-texture"></div>
                                <svg class="seal-svg" viewBox="0 0 100 100">
                                    <defs>
                                        <radialGradient id="seal-gradient" cx="50%" cy="50%" r="50%">
                                            <stop offset="0%" stop-color="#e62e2e" />
                                            <stop offset="90%" stop-color="#8a0a0a" />
                                        </radialGradient>
                                        <filter id="wax-glow">
                                            <feGaussianBlur in="SourceGraphic" stdDeviation="2" result="blur" />
                                            <feComposite in="SourceGraphic" in2="blur" operator="over" />
                                        </filter>
                                    </defs>
                                    <circle cx="50" cy="50" r="45" fill="url(#seal-gradient)"
                                        style="filter: drop-shadow(0 4px 6px rgba(0,0,0,0.4));" />
                                    <!-- Inner Ring -->
                                    <circle cx="50" cy="50" r="38" fill="none" stroke="#680505" stroke-width="2"
                                        stroke-dasharray="2,2" />
                                    <!-- Icon -->
                                    <path d="M30,40 Q50,20 70,40 Q50,90 30,40" fill="none" stroke="#ffcccc"
                                        stroke-width="2" opacity="0.8" />
                                    <text x="50" y="55" font-family="'Playfair Display', serif" font-size="28"
                                        fill="#ffcccc" text-anchor="middle" dominant-baseline="middle"
                                        style="text-shadow: 1px 1px 2px #4a0404;">Sí</text>
                                    <!-- Progress Ring (Hidden initially) -->
                                    <circle class="progress-fill" cx="50" cy="50" r="45" fill="none" stroke="#D4AF37"
                                        stroke-width="4" stroke-dasharray="283" stroke-dashoffset="283"
                                        transform="rotate(-90 50 50)" />
                                </svg>
                            </button>
                            <p class="seal-instruction">Mantén presionado para sellar</p>
                        </div>
                    </div>

                    <!-- Golden Ticket Reveal -->
                    <div id="rsvp-ticket-container" class="ticket-perspective" style="display: none;">
                        <div id="golden-ticket" class="golden-ticket luxury-black-card">
                            <!-- Texture & Effects -->
                            <div class="card-noise"></div>
                            <div class="card-hologram"></div>
                            <div class="card-border-glow"></div>

                            <!-- Top Section -->
                            <div class="card-top">
                                <div class="gold-chip">
                                    <div class="chip-line"></div>
                                    <div class="chip-line"></div>
                                    <div class="chip-line"></div>
                                </div>
                                <span class="card-brand">ROYAL INVITATION</span>
                            </div>

                            <!-- Main Content -->
                            <div class="card-body">
                                <h3 class="card-title">San Valentín <span class="text-gold">2026</span></h3>
                                <div class="card-details-grid">
                                    <div class="detail-item">
                                        <span class="d-label">FECHA</span>
                                        <span class="d-value">14 FEB</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="d-label">HORA</span>
                                        <span class="d-value">11:30 PM</span>
                                    </div>
                                    <div class="detail-item full">
                                        <span class="d-label">DESTINO</span>
                                        <span class="d-value">All You Can Eat Caracas</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Footer -->
                            <div class="card-footer-row">
                                <div class="card-qr">
                                    <svg viewBox="0 0 100 100" fill="white">
                                        <rect x="0" y="0" width="40" height="40" />
                                        <rect x="60" y="0" width="40" height="40" />
                                        <rect x="0" y="60" width="40" height="40" />
                                        <rect x="50" y="50" width="20" height="20" rx="4" />
                                        <rect x="20" y="50" width="10" height="10" />
                                        <rect x="50" y="20" width="10" height="10" />
                                    </svg>
                                </div>
                                <div class="card-serial">
                                    <span>Nº 0001402</span>
                                    <span class="auth-text">AUTHORIZED ACCESS</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Footer -->
                <footer class="card-footer">
                    <p class="footer-text">Hecho con ❤️ para ti</p>
                </footer>
            </div>
        </article>
    </main>

    <!-- Audio Toggle Button -->
    <button id="audio-toggle" class="audio-toggle" aria-label="Silenciar" onclick="toggleAudioMute()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path
                d="M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"
                stroke-linecap="round" stroke-linejoin="round" />
        </svg>
    </button>

    <!-- Scripts (modular, defer = ejecutan en orden tras HTML) -->
    <script type="module" src="app.js"></script>
</body>

</html>